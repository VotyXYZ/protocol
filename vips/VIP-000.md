# VIP-000: Basic concepts

This VIP defines the basic concepts.

## User

1 DID = 1 User

> DID stand for Decentralized Identifier

Each software `MAY` choose what kinds of DID systems they want to support.

All supported DID systems are registered [here](/vips/VIP-001.md).

## Document

There are 3 types of document in JSON format:

- **Organization**: a hub for all related proposals.

  ```ts
  {
    name: string;
    groups: Array<{
      name: string;
      timing: {
        publicity: number; // voting start delay
        voting: number; // voting period duration
      };
      proposing_liberty: {
        // a tree structure to filter users who can propose.
      };
      voting_power: {
        // a tree structure to calculate users' voting power.
      };
    }>;
  }
  ```

- **Proposal**: describes the issue of a vote.

  ```ts
  {
    organization: string; // belongs to which organization
    group: number; // index of organization's group
    title: string;
    promise: string; // the effect of the proposal
    choices: string[]; // voting options
    snapshots: { [coin_type: string]: string }; // records of blockchains' height
  }
  ```

- **Vote**: voter's vote of a proposal.

  ```ts
  {
    proposal: string; // belongs to which proposal
    choice: string; // choice of user
  }
  ```

All of the documents `MUST` be stored in a storage.

All supported storage providers are registered [here](/vips/VIP-002.md).

## Signature

Every type of document contains a field called `signature`:

```ts
{
  ...,
  signature: {
    did: string // DID name
    coin_type: number // SLIP-0044 coin_type of a blockchain
    snapshot: string // block_height of blockchain
    address: string // resolved blockchain wallet address
    data: string // base64 string of signature
  }
}
```

A DID `SHOULD` be resolved to a certain wallet address with given coin_type and block_height. Then we use the resolved wallet for signature.

```
     coin_type + block_height
DID -------------------------> wallet address
```

Here is a piece of pseudo code shows how signature is calculated:

```ts
function sign_document(document) {
  const hash = to_hex(sha_256(json_stringify(document)));
  const message = `You are signing for Voty Protocol.\n\nhash: 0x${hash}`;
  return binary_to_base64(wallet_sign(message));
}
```

Here is another piece of pseudo code shows how to verify signature:

```ts
function verify_signature(message, signature) {
  const address = resolve_did(
    signature.did,
    signature.coin_type,
    signature.snapshot
  );
  return (
    address == signature.address &&
    address == recover_address(message, base64_to_binary(signature.data))
  );
}
```
